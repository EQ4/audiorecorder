<html>
    <head>
        <title>AudioRecorder Example</title>
        <script type="text/javascript" src="../build/release/audiorecorder.js"></script>
        <script type="text/javascript">
            var config = {
                'worker_path': '../build/release/worker.js'
            };
            var clips = [];

            var callback = function(clip) {
                var i = clips.length;
                clips.push(clip);
                var newClipHTML = "<a id='clip" + i + "' href='javascript:setCurrentClip(" + i + ")'>" + i + "</a> ";
                document.getElementById("clips").innerHTML += newClipHTML;

                // Select the first clip.
                if (i == 0) {
                    setCurrentClip(0);
                }
            };
            var convert = function(clip) {
                var newClip = Clip.createFromSpeex(clip.speex);
                callback(newClip);
            }

            var currentClip = 0;
            var setCurrentClip = function(i) {
                document.getElementById("clip" + currentClip).style.color = "blue";
                currentClip = i;
                document.getElementById("clip" + i).style.color = "red";
            };
        </script>
    </head>
    <body>
        <p>
        <button onclick="AudioRecorder.init(config);">
            AudioRecorder.init(config)
        </button>

        <p>
        <button onclick="AudioRecorder.record();">
            AudioRecorder.record()
        </button>
        <button onclick="AudioRecorder.stopRecording(callback);">
            AudioRecorder.stopRecording(callback)
        </button>

        <p>
        <button onclick="AudioRecorder.playClip(clips[currentClip]);">
            AudioRecorder.playClip(clip)
        </button>
        <button onclick="AudioRecorder.stopPlaying();">
            AudioRecorder.stopPlaying()
        </button>

        <p>
        Clips: <span id="clips"></span>

        <p>
        <button onclick="convert(clips[currentClip]);">
            newClip = Clip.createFromSpeex(clip.speex);
        </button>

        <p>
        To run this example, run the command:<br/>
        python -m SimpleHTTPServer 8081<br/>
        Then visit <a href="http://localhost:8081/examples/recorder.html">http://localhost:8081/examples/recorder.html</a>.<br/>
        Or do the equivalent on your system... but it won't work if you just open recorder.html in a browser.
    </body>
</html>
